<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friendship Quiz</title>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
      import { getDatabase, ref, set, push } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBTlvvGGWKaAsOyQ4zSeJ5aID_eD3nMfkI",
        authDomain: "truth-dare-5a92c.firebaseapp.com",
        projectId: "truth-dare-5a92c",
        storageBucket: "truth-dare-5a92c.firebasestorage.app",
        messagingSenderId: "299104332770",
        appId: "1:299104332770:web:469c2a277ad01e57efa7bb",
        measurementId: "G-NER090QMCZ"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);

      // Sample questions
      const questions = [
        {
          id: 'q1',
          text: 'What\'s your favorite color?',
          options: ['Red', 'Blue']
        },
        {
          id: 'q2',
          text: 'What\'s your favorite animal?',
          options: ['Dog', 'Cat']
        }
      ];

      // Render questions
      function renderQuestions() {
        const container = document.getElementById('quiz-container');
        questions.forEach((question, index) => {
          const questionElement = document.createElement('div');
          questionElement.classList.add('question');

          const questionText = document.createElement('p');
          questionText.textContent = question.text;
          questionElement.appendChild(questionText);

          question.options.forEach(option => {
            const optionLabel = document.createElement('label');
            const input = document.createElement('input');
            input.type = 'radio';
            input.name = `q${index}`;
            input.value = option;
            optionLabel.appendChild(input);
            optionLabel.appendChild(document.createTextNode(option));
            questionElement.appendChild(optionLabel);
          });

          container.appendChild(questionElement);
        });
      }

      // Save quiz answers to Firebase
      function generateQuizLink() {
        const selectedAnswers = {};
        questions.forEach((question, index) => {
          const selectedOption = document.querySelector(`input[name="q${index}"]:checked`);
          if (selectedOption) {
            selectedAnswers[question.id] = selectedOption.value;
          }
        });

        if (Object.keys(selectedAnswers).length === questions.length) {
          const quizId = push(ref(database, 'quizzes')).key;
          set(ref(database, 'quizzes/' + quizId), {
            questions: questions,
            answers: selectedAnswers
          });

          // Generate link
          const quizLink = window.location.origin + `/play.html?quizId=${quizId}`;
          document.getElementById('quiz-link').textContent = quizLink;
          document.getElementById('quiz-link').setAttribute('href', quizLink);
        } else {
          alert('Please answer all the questions!');
        }
      }

      // Wait for DOM to load
      document.addEventListener('DOMContentLoaded', () => {
        renderQuestions();
      });
    </script>
</head>
<body>
    <h1>Friendship Quiz</h1>
    <div id="quiz-container"></div>
    <button onclick="generateQuizLink()">Generate Quiz Link</button>
    <br>
    <a id="quiz-link" target="_blank"></a>
</body>
</html>
